<record>
  <header>
    <identifier><%= record.uuid %></identifier>
    <datestamp><%= timestamp record.updated_at %></datestamp>
  </header>
  <metadata>
    <oai_dc:dc
      xmlns:oai_dc="http://www.openarchives.org/OAI/2.0/oai_dc/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:kor="http://coneda.net/XMLSchema/1.0/"
      xsi:schemaLocation="http://www.openarchives.org/OAI/2.0/oai_dc/ 
                          http://www.openarchives.org/OAI/2.0/oai_dc.xsd"
    >
      <dc:identifier><%= record.uuid %></dc:identifier>
      <dc:type>Dataset</dc:type>
      <dc:type>Object</dc:type>

      <% if record.is_medium? %>
        <dc:type><%= record.medium.content_type %></dc:type>
        <dc:relation><%= medium_url record.medium %></dc:relation>
      <% else %>
        <dc:title><%= record.name %></dc:title>
      <% end %>

      <dc:description>
        <kor:type kor:id="<%= record.kind.uuid %>"><%= record.kind.name %></kor:type>

        <% unless record.is_medium? %>
          <kor:distinction><%= record.distinct_name %></kor:distinction>
          <% record.synonyms.each do |synonym| %>
            <kor:synonym><%= synonym %></kor:synonym>
          <% end %>
        <% end %>
        
        <kor:tags>
          <% record.tag_list.each do |tag| %>
            <kor:tag><%= tag %></kor:tag>
          <% end %>
        </kor:tags>

        <kor:fields>
          <% record.field_hashes.each do |field| %>
            <kor:field kor:name="<%= field['name'] %>"
            ><%= field['value'] %></kor:field>
          <% end %>
        </kor:fields>

        <kor:properties>
          <% record.properties.each do |property| %>
            <kor:property
              kor:name="<%= property['label'] %>"
            ><%= property['value'] %></kor:property>
          <% end %>
        </kor:properties>

        <kor:datings>
          <% record.datings.each do |dating| %>
            <kor:dating
              kor:event="<%= dating.label %>"
              kor:from-day="<%= dating.from_day %>"
              kor:to-day="<%= dating.to_day %>"
            ><%= dating.dating_string %></kor:dating>
          <% end %>
        </kor:datings>

        <kor:comment><%= record.comment %></kor:comment>
      </dc:description>

    </oai_dc:dc>
  </metadata>
</record>
